<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phân Công - UpFile</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <nav class="navbar">
        <div class="brand">UpFile Admin</div>
        <div class="user-controls">
            <a href="index.html" class="btn-text">← Quay lại Dashboard</a>
        </div>
    </nav>

    <div class="container">
        <div class="card">
            <div class="card-header">
                <h2>Tạo Phân Công Mới</h2>
                <p>Chọn các thông tin để tạo mục nộp file cho giáo viên.</p>
            </div>
            <div class="card-body">
                <form id="assignForm">
                    <div class="grid-2">
                        <div class="form-group">
                            <label>Năm học</label>
                            <select id="selSchoolYear" class="form-control" required></select>
                        </div>
                        <div class="form-group">
                            <label>Kỳ kiểm tra</label>
                            <select id="selFolder" class="form-control" required></select>
                        </div>
                        <div class="form-group">
                            <label>Môn học</label>
                            <select id="selSubject" class="form-control" required></select>
                        </div>
                        <div class="form-group">
                            <label>Khối lớp</label>
                            <select id="selBlock" class="form-control" required></select>
                        </div>
                        <div class="form-group">
                            <label>Đối tượng áp dụng</label>
                            <select id="selObject" class="form-control" required></select>
                        </div>
                        <div class="form-group">
                            <label>Loại văn bản (DocType)</label>
                            <select id="selDocType" class="form-control" required></select>
                        </div>
                    </div>
                    
                    <div class="form-group mt-2">
                        <label>Giáo viên thực hiện (Chọn AccountUpdate)</label>
                        <select id="selUser" class="form-control" required>
                            <option value="">-- Chọn giáo viên --</option>
                        </select>
                    </div>

                    <div class="form-actions right mt-3">
                        <button type="submit" class="btn btn-primary btn-lg">Lưu Phân Công</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            checkAuth(); 
            // Chỉ admin mới được vào trang này
            const user = JSON.parse(localStorage.getItem('upfile_user'));
            if (!user || user.Permissions !== 'Admin') {
                alert('Bạn không có quyền truy cập trang này!');
                window.location.href = 'index.html';
                return;
            }
            loadAssignData(); // Tải dữ liệu để fill vào các select box
        });
    </script>
</body>
</html>
